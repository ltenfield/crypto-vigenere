<html>
<head>
    <link href="https://d3njjcbhbojbot.cloudfront.net/webapps/builds/ondemand/app.c35c6fbba4ccb6bbbc67.css" rel="stylesheet">
</head>
<body>
<div><p>(Note that programming assignments are optional.)</p><p>Write a program that allows you to "crack" ciphertexts generated using a Vigenere-like cipher, where byte-wise XOR is used instead of addition modulo 26. </p><p>Specifically, the ciphertext</p><figure><img src="https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/lQ36hBwvEeWZwgof2KHC4w_3fec6f3d4ef2c9593963e28b8e21aa49_Screen-Shot-2015-06-26-at-11.15.55-AM.png?expiry=1514073600000&amp;hmac=0XwjRKEL-ATOP2QE5DxLN4CULN1cM10uyxN-SOr0kFc" alt="" data-asset-id="lQ36hBwvEeWZwgof2KHC4w"></figure><pre contenteditable="false" style="opacity: 1;"><div data-reactroot="" class="rc-CodeBlock ace_editor ace-tomorrow" style="height: 182px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 73.8988px; top: 168px; height: 14px; width: 7.22469px;" role="presentation" aria-hidden="true" tabindex="-1"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 546px; width: 41px;"><div class="ace_gutter-cell " style="height: 182px;">1</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 182px;"></div></div><div class="ace_scroller" style="left: 41px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 639px; height: 546px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 581.975px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:182px"><div class="ace_line" style="height:14px">F96DE8C227A259C87EE1DA2AED57C93FE5DA36ED4EC87EF2C63AAE5B9A7EFFD673BE4ACF7BE8923C</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;AB1ECE7AF2DA3DA44FCF7AE29235A24C963FF0DF3CA3599A70E5DA36BF1ECE77F8DC34BE129A6C</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;F4D126BF5B9A7CFEDF3EB850D37CF0C63AA2509A76FF9227A55B9A6FE3D720A850D97AB1DD35ED</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;5FCE6BF0D138A84CC931B1F121B44ECE70F6C032BD56C33FF9D320ED5CDF7AFF9226BE5BDE3FF7</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;DD21ED56CF71F5C036A94D963FF8D473A351CE3FE5DA3CB84DDB71F5C17FED51DC3FE8D732BF4D</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;963FF3C727ED4AC87EF5DB27A451D47EFD9230BF47CA6BFEC12ABE4ADF72E29224A84CDF3FF5D7</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;20A459D47AF59232A35A9A7AE7D33FB85FCE7AF5923AA31EDB3FF7D33ABF52C33FF0D673A551D9</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;3FFCD33DA35BC831B1F43CBF1EDF67F0DF23A15B963FE5DA36ED68D378F4DC36BF5B9A7AFFD121</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;B44ECE76FEDC73BE5DD27AFCD773BA5FC93FE5DA3CB859D26BB1C63CED5CDF3FE2D730B84CDF3F</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;F7DD21ED5ADF7CF0D636BE1EDB79E5D721ED57CE3FE6D320ED57D469F4DC27A85A963FF3C727ED</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;49DF3FFFDD24ED55D470E69E73AC50DE3FE5DA3ABE1EDF67F4C030A44DDF3FF5D73EA250C96BE3</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;D327A84D963FE5DA32B91ED36BB1D132A31ED87AB1D021A255DF71B1C436BF479A7AF0C13AA147</div><div class="ace_line" style="height:14px">&nbsp;&nbsp;94</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 32.8987px; top: 168px; width: 7.22469px; height: 14px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 182px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 41px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 639px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></pre><p>was generated by encrypting English-language text using the following C program:</p><figure><img src="https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/qp84dhwvEeWZnA5Jwkcf5w_e84624dee4df70f2dc947a77462dff73_Screen-Shot-2015-06-26-at-11.15.27-AM.png?expiry=1514073600000&amp;hmac=YcTbQAmg05uq_g12bzXc616hnCjN7_91aDsqw7NGOAU" alt="" data-asset-id="qp84dhwvEeWZnA5Jwkcf5w"></figure><pre contenteditable="false" data-language="c_cpp" style="opacity: 1;"><div data-reactroot="" class="rc-CodeBlock ace_editor ace-tomorrow" style="height: 392px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 66.4494px; top: 378px; height: 14px; width: 7.22469px;" role="presentation" aria-hidden="true" tabindex="-1"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 420px; width: 48px;"><div class="ace_gutter-cell " style="height: 14px;">1</div><div class="ace_gutter-cell " style="height: 14px;">2</div><div class="ace_gutter-cell " style="height: 14px;">3<span class="ace_fold-widget ace_start ace_open" style="height: 14px;"></span></div><div class="ace_gutter-cell " style="height: 14px;">4</div><div class="ace_gutter-cell " style="height: 14px;">5</div><div class="ace_gutter-cell " style="height: 14px;">6</div><div class="ace_gutter-cell " style="height: 14px;">7</div><div class="ace_gutter-cell " style="height: 14px;">8</div><div class="ace_gutter-cell " style="height: 14px;">9</div><div class="ace_gutter-cell " style="height: 14px;">10</div><div class="ace_gutter-cell " style="height: 14px;">11</div><div class="ace_gutter-cell " style="height: 14px;">12<span class="ace_fold-widget ace_start ace_open" style="height: 14px;"></span></div><div class="ace_gutter-cell " style="height: 14px;">13</div><div class="ace_gutter-cell " style="height: 14px;">14<span class="ace_fold-widget ace_start ace_open" style="height: 14px;"></span></div><div class="ace_gutter-cell " style="height: 14px;">15</div><div class="ace_gutter-cell " style="height: 14px;">16</div><div class="ace_gutter-cell " style="height: 14px;">17</div><div class="ace_gutter-cell " style="height: 14px;">18</div><div class="ace_gutter-cell " style="height: 14px;">19<span class="ace_fold-widget ace_start ace_open" style="height: 14px;"></span></div><div class="ace_gutter-cell " style="height: 28px;">20</div><div class="ace_gutter-cell " style="height: 14px;">21</div><div class="ace_gutter-cell " style="height: 14px;">22</div><div class="ace_gutter-cell " style="height: 14px;">23</div><div class="ace_gutter-cell " style="height: 14px;">24</div><div class="ace_gutter-cell " style="height: 14px;">25</div><div class="ace_gutter-cell " style="height: 14px;">26</div><div class="ace_gutter-cell " style="height: 14px;">27</div></div><div class="ace_gutter-active-line" style="top: 378px; height: 14px;"></div></div><div class="ace_scroller" style="left: 48px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 632px; height: 420px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 581.975px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px"><span class="ace_keyword">#include</span><span class="ace_constant ace_other"> &lt;stdio.h&gt;</span><span class="ace_keyword">#define</span><span class="ace_constant ace_other"> KEY_LENGTH 2 </span><span class="ace_comment">// Can be anything from 1 to 13</span></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px"></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px"><span class="ace_identifier">main</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span><span class="ace_paren ace_lparen">{</span>  </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_storage ace_type">unsigned</span> <span class="ace_storage ace_type">char</span> <span class="ace_identifier">ch</span><span class="ace_punctuation ace_operator">;</span>  </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_identifier">FILE</span> <span class="ace_keyword ace_operator">*</span><span class="ace_identifier">fpIn</span><span class="ace_punctuation ace_operator">,</span> <span class="ace_keyword ace_operator">*</span><span class="ace_identifier">fpOut</span><span class="ace_punctuation ace_operator">;</span>  </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_storage ace_type">int</span> <span class="ace_identifier">i</span><span class="ace_punctuation ace_operator">;</span>  <span class="ace_storage ace_type">unsigned</span> <span class="ace_storage ace_type">char</span> <span class="ace_identifier">key</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">KEY_LENGTH</span><span class="ace_paren ace_rparen">]</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">{</span><span class="ace_constant ace_numeric">0x00</span><span class="ace_punctuation ace_operator">,</span> <span class="ace_constant ace_numeric">0x00</span><span class="ace_paren ace_rparen">}</span><span class="ace_punctuation ace_operator">;</span></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_comment">/* of course, I did not use the all-0s key to encrypt */</span></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px"></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_identifier">fpIn</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_support ace_function ace_C99 ace_c">fopen</span><span class="ace_paren ace_lparen">(</span><span class="ace_string ace_start">"</span><span class="ace_string">ptext.txt</span><span class="ace_string ace_end">"</span><span class="ace_punctuation ace_operator">,</span> <span class="ace_string ace_start">"</span><span class="ace_string">r</span><span class="ace_string ace_end">"</span><span class="ace_paren ace_rparen">)</span><span class="ace_punctuation ace_operator">;</span>  </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_identifier">fpOut</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_support ace_function ace_C99 ace_c">fopen</span><span class="ace_paren ace_lparen">(</span><span class="ace_string ace_start">"</span><span class="ace_string">ctext.txt</span><span class="ace_string ace_end">"</span><span class="ace_punctuation ace_operator">,</span> <span class="ace_string ace_start">"</span><span class="ace_string">w</span><span class="ace_string ace_end">"</span><span class="ace_paren ace_rparen">)</span><span class="ace_punctuation ace_operator">;</span></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_identifier">i</span><span class="ace_keyword ace_operator">=</span><span class="ace_constant ace_numeric">0</span><span class="ace_punctuation ace_operator">;</span>  </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_keyword ace_control">while</span> <span class="ace_paren ace_lparen">(</span><span class="ace_support ace_function ace_C99 ace_c">fscanf</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">fpIn</span><span class="ace_punctuation ace_operator">,</span> <span class="ace_string ace_start">"</span><span class="ace_constant ace_language ace_escape">%c</span><span class="ace_string ace_end">"</span><span class="ace_punctuation ace_operator">,</span> <span class="ace_keyword ace_operator">&amp;</span><span class="ace_identifier">ch</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">!=</span> <span class="ace_identifier">EOF</span><span class="ace_paren ace_rparen">)</span> <span class="ace_paren ace_lparen">{</span></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">    <span class="ace_comment">/* avoid encrypting newline characters */</span>      </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">   <span class="ace_comment">/* In a "real-world" implementation of the Vigenere cipher,        </span></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px"><span class="ace_comment">      every ASCII character in the plaintext would be encrypted.       </span></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px"><span class="ace_comment">      However, I want to avoid encrypting newlines here because        </span></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px"><span class="ace_comment">      it makes recovering the plaintext slightly more difficult... */</span>    </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">   <span class="ace_comment">/* ...and my goal is not to create "production-quality" code =) */</span>    </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">   <span class="ace_keyword ace_control">if</span> <span class="ace_paren ace_lparen">(</span><span class="ace_identifier">ch</span><span class="ace_keyword ace_operator">!=</span><span class="ace_string">'\n'</span><span class="ace_paren ace_rparen">)</span> <span class="ace_paren ace_lparen">{</span>      </div></div><div class="ace_line_group" style="height:28px"><div class="ace_line" style="height:14px">     <span class="ace_support ace_function ace_C99 ace_c">fprintf</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">fpOut</span><span class="ace_punctuation ace_operator">,</span> <span class="ace_string ace_start">"</span><span class="ace_constant ace_language ace_escape">%0</span><span class="ace_string">2X</span><span class="ace_string ace_end">"</span><span class="ace_punctuation ace_operator">,</span> <span class="ace_identifier">ch</span> ^ <span class="ace_identifier">key</span><span class="ace_paren ace_lparen">[</span><span class="ace_identifier">i</span> <span class="ace_keyword ace_operator">%</span> <span class="ace_identifier">KEY_LENGTH</span><span class="ace_paren ace_rparen">])</span><span class="ace_punctuation ace_operator">;</span> <span class="ace_comment">// ^ is logical XOR      </span></div><div class="ace_line" style="height:14px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ace_comment">    </span></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">     <span class="ace_identifier">i</span><span class="ace_keyword ace_operator">++</span><span class="ace_punctuation ace_operator">;</span>      <span class="ace_paren ace_rparen">}</span>    </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_paren ace_rparen">}</span>   </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px"> </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_support ace_function ace_C99 ace_c">fclose</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">fpIn</span><span class="ace_paren ace_rparen">)</span><span class="ace_punctuation ace_operator">;</span>  </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_support ace_function ace_C99 ace_c">fclose</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">fpOut</span><span class="ace_paren ace_rparen">)</span><span class="ace_punctuation ace_operator">;</span>  </div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px">  <span class="ace_keyword ace_control">return</span><span class="ace_punctuation ace_operator">;</span></div></div><div class="ace_line_group" style="height:14px"><div class="ace_line" style="height:14px"><span class="ace_paren ace_rparen">}</span> </div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 18.4494px; top: 378px; width: 7.22469px; height: 14px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 392px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 48px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 632px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div></pre><p>(Of course, when encrypting I used a random key length and chose each byte of the key at random.) The plaintext contains upper- and lower-case letters, punctuation, and spaces, but no numbers.</p><p></p><p></p><p></p><p></p></div>
</body>
</html>